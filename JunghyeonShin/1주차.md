# 01 웹 브라우저가 메시지를 만든다
## 1. HTTP 리퀘스트 메시지를 작성한다
- URL(Uniform Resource Locator) : 탐험 여행의 출발점, 브라우저의 기능 중의 어느 것을 사용하여 데이터에 액세스하면 좋을 것인지를 판단하는 재료
	- 브라우저의 기능
		- 웹 서버에 액세스하는 클라이언트 기능
		- 파일을 다운로드/업로드 하는 FTP(File Transfer Protocol)의 클라이언트 기능
		- 메일의 클라이언트 기능
- 모든 URL의 공통점 : 맨 앞에 있는 문자열(http:, ftp:, mailto:, file:)에서 액세스 하는 방법을 나타냄

- 브라우저의 처음 일 : 웹 서버에 보내는 리퀘스트의 메시지를 작성하기 위해  URL을 해독
- 이 책에서는 웹 서버에 액세스하는 경우를 설명
>>http://www.lab.cyber.co.kr/dir1/file1/html

- 파일명을 생략한 경우
	- http://www.lab.cyber.co.kr/dir/
		- URL의 규칙에는 파일명을 생략해도 됨
		- 파일명을 쓰지 않으면 어느 파일에 액세스해야 할지 모르기 때문에, 미리 서버측에 설정해 둠
		- 서버에 따라 다르지만 대부분의 서버가 'index.html' 또는 'default.htm'
	- http://www.lab.cyber.co.kr/
		- 루트 디렉토리가 지정되고 파일명은 생략된 것
		- '/index.html', '/default.htm'이라는 파일에 액세스
	- http://www.lab.cyber.co.kr
		- '/index.html', '/default.htm'이라는 파일에 액세스
	- http://www.lab.cyber.co.kr/whatisthis
		- 웹 서버에 'whatisthis'라는 파일이 있으면 whatisthis를 파일명으로 보고, 'whatisthis'라는 디렉토리가 있으면 whatisthis를 디렉토리명으로 봄

- HTTP(HyperText Transfer Protocol)를 사용하여 웹 서버에 액세스함
- HTTP의 기본 개념
	- 클라이언트와 서버가 주고받는 메시지의 내용이나 순서를 정한 것
	1. 클라이언트에서 서버를 향해 리퀘스트 메시지를 보냄
		- '무엇을' : URI(Uniform Resource Identifier)
			- 페이지 데이터를 저장한 파일의 이름
			- CGI(Common Gateway Interface) 프로그램의 파일명
			- URL을 그대로도 사용
		- '어떻게 해서' : 메소드
			- 웹 서버에게 어떤 동작을 하고 싶은지를 전달
			- GET : 웹 서버에 액세스하여 페이지의 데이터를 읽을 때 사용
			- POST : 폼에 데이터를 사용해서 웹 서버에 송신
		- 보충 정보를 나타내는 헤더 파일도 있음
		- 헤더 필드의 뒤에 데이터가 들어감
	2. 리퀘스트 메시지가 웹 서버에 도착하면 웹 서버는 그 속에 쓰여있는 내용을 해독
	3. URI와 메시지를 조사하여 판단한 후 요구에 따라 동작하고, 결과 데이터를 응답 메시지에 저장
		- 응답 메시지의 맨 앞부분에는 스테이터스 코드
		- 헤더 파일과 페이지의 데이터
	4. 클라이언트에 도착하여 브라우저가 메시지의 안에서 데이터를 추출하여 화면에 표시

- 리퀘스트 메세지
	- 리퀘스트 라인
		- 웹 서버에 어떻게 할 것인지를 전달
		1. 메소드를 입력
		2. 한 칸 띄운 다음 URI 입력
		3. 한 칸 띄운 다음 HTTP의 버전 번호 입력
	- 메시지 헤더
		- 부가적인 자세한 정보
	- 메시지 본문
		- 메시지 헤더를 쓰고 난 뒤 한 행 띄운 다음 송신한 데이터를 씀

- 응답 메세지가 되돌아옴
	- 스테이터스 코드와 응답 문구를 첫 번째 행에 입력
		- 내용은 같지만 용도가 다름
			- 스테이터스 코드 : 숫자로 쓰여 있음, 주로 프로그램 등에 실행 결과를 알려주는 것
			- 응답 문구 : 문장으로 쓰여 있음, 사람에게 실행 결과를 알림
	- 영상 등을 포함한 경우에는 문장 안에 영상 파일을 나타내는 태그가 포함
	- 화면에 문장을 표시할 때 태그를 탐색하고, 영상용 공백을 비워두고 문장을 표시
	- 다시 한 번 웹 서버에 액세스하여 태그에 쓰여있는 영상 파일을 웹 서버에서 읽어와서 공백에 표시
		- URI 부분에 영상 파일의 이름을 쓴 리퀘스트 메시지를 만들어 보냄
- 리퀘스트 메시지에 쓴느 URI는 한 개만으로 결정되어 있음	

## 2. 웹 서버의 IP 주소를 DNS 서버에 조회한다
- IP 주소
	- 네트워크 번호와 호스트 번호를 합친 주소
	- 호스트 번호 부분의 비트 값이 모두 0 또는 1인 경우는 특별한 의미를 가짐
		- 0 : 서브넷 자체를 나타냄
		- 1 : 서브넷에 있는 기기 전체에 패킷을 보내는 브로드 캐스트를 나타냄

- 도메인명과 IP 주소를 구분하여 사용하는 이유
	- 숫자를 나열한 IP 주소는 기억하기 어려움, 도메인명을 쓸 수 있도록 하는 쪽이 좋음
	- IP 주소에 의해 목적지가 어디에 있는지를 판단하면서 데이터를 운반
		- 만약 도메인명을 사용하면 라우터가 부하되어 데이터를 운반하는 동작에 더 많은 시간이 걸리면서 네트워크의 속도가 느려짐
	- 사람은 도메인명을, 라우터는 IP 주소를 사용하는 방법 : DNS(Domain Name System)

- DNS 서버에 조회
	- DNS 서버에 조회 메시지를 보내고, 거기에서 반송되는 응답 메시지를 받는 것
	- DNS 리졸브 : DNS 클라이언트
	- 네임 리졸루션 : DNS의 원리를 사용하여 IP 주소를 조사하는 것
- Socket 라이브러리
	- OS에 포함되어 있는 네트워크의 기능을 애플리케이션에서 호출하기 위한 부품을 모아놓은 것

- 리졸버의 프로그램명과 웹 서버의 이름을 쓰기만 하면 리졸버를 호출할 수 있음
- 리졸버를 호출하면 리졸버가 DNS 서버에 조회 메시지를 보내고, DNS 서버에서 응답 메시지가 돌아옴
	- 응답 메시지 속에 IP 주소가 포함
	- 리졸버는 이것을 추출하여 브라우저에서 지정한 메모리 영역에 씀
- 이 메모리 영역에서 IP 주소를 추출하여 HTTP의 리퀘스트 메시지와 함께 OS에 건네주어 송신을 의뢰

- 리졸버 내부의 작동
	1. 브라우저가 리졸버를 호출하면 제어가 리졸버의 내부로 넘어감
	2. 리졸버는 DNS 서버에 문의하기 위한 메시지를 만듦
	3. 리졸버는 OS의 프로토콜 스택을 호출하여 실행을 의뢰함
	4. DNS 서버에 도착하고 DNS 서버는 메시지에 쓰여있는 조회 내용을 조사하여 답을 찾음
	5. 액세스 대상의 웹 서버가 DNS 서버에 등록되어 있으면 탑을 응답 메시지에 써서 클라이언트에게 반송
	6. 메시지는 네트워크를 통해 클라이언트측에 도착하고, 프로토콜 스택을 경유하여 리졸버에 건너져 리졸버가 내용을 해독한 후 IP 주소를 추출하여 건네줌
	7. 리졸버의 동작이 끝나고 제어가 브라우저에게 돌아옴